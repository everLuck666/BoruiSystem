(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-590eeb51"],{4578:function(t,e,s){},"47b0":function(t,e,s){t.exports=s.p+"img/icon_sent.cfb39823.png"},"5fa1":function(t,e,s){"use strict";s("c446")},c446:function(t,e,s){},d8bf:function(t,e,s){"use strict";s("4578")},eabe:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"customer"}},[a("div",{staticClass:"title"},[t._v("客户管理")]),a("div",{staticClass:"top"},[a("div",{staticClass:"left"},[t._v("客户信息管理")]),a("div",{staticClass:"btn",on:{click:function(e){return t.exportCustomer()}}},[t._v("导出")])]),a("el-table",{staticClass:"table",staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:t.tableData,height:"400"}},[a("el-table-column",{attrs:{label:"订阅",align:"center","mid-width":"5%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:"true"===e.row.subscribeStatus,expression:"scope.row.subscribeStatus === 'true'"}],staticStyle:{color:"red"}},[t._v("是")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"false"===e.row.subscribeStatus,expression:"scope.row.subscribeStatus === 'false'"}],staticStyle:{color:"gray"}},[t._v("否")])]}}])}),a("el-table-column",{attrs:{prop:"userName",label:"客户姓名",align:"center","mid-width":"10%"}}),a("el-table-column",{attrs:{prop:"phone",label:"联系方式",align:"center","mid-width":"10%"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center","mid-width":"15%"}}),a("el-table-column",{attrs:{prop:"address",label:"收货地址",align:"center","mid-width":"25%"}}),a("el-table-column",{attrs:{prop:"productName",label:"购买商品",align:"center","mid-width":"20%"}}),a("el-table-column",{attrs:{label:"操作",align:"center","mid-width":"5%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(s){return t.getDelId(e.row)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"paging"},[a("div",{staticClass:"btn",on:{click:function(e){return t.getCustomerPage(1)}}},[t._v("首页")]),a("div",{staticClass:"btn",on:{click:function(e){return t.getCustomerPage(t.paging.prePage)}}},[t._v("上一页")]),a("div",{staticClass:"btn",on:{click:function(e){return t.getCustomerPage(t.paging.nextPage)}}},[t._v("下一页")]),a("div",{staticClass:"word"},[t._v("第"+t._s(t.paging.page)+"页")]),a("div",{staticClass:"word"},[t._v("共"+t._s(t.paging.pageNum)+"页")])]),a("div",{staticClass:"msg"},[a("div",{staticClass:"title"},[t._v("客户通知管理")]),a("div",{staticClass:"title",staticStyle:{"font-size":"18px"}},[t._v("编辑短信")]),a("div",{staticClass:"content"},[a("el-input",{staticClass:"textarea",attrs:{type:"textarea",rows:6,placeholder:"请输入短信内容"},model:{value:t.msg.textarea,callback:function(e){t.$set(t.msg,"textarea",e)},expression:"msg.textarea"}}),a("div",{staticClass:"checkBox"},[a("el-radio-group",{staticStyle:{zoom:"120%"},model:{value:t.msg.customer,callback:function(e){t.$set(t.msg,"customer",e)},expression:"msg.customer"}},[a("el-radio",{attrs:{label:"0"}},[t._v("订阅客户")]),a("el-radio",{attrs:{label:"1"}},[t._v("全部客户")])],1)],1),a("div",{staticClass:"sentBtn",on:{click:function(e){return t.sendSms()}}},[a("img",{attrs:{src:s("47b0"),alt:""}}),a("p",{staticClass:"sent"},[t._v("立即发送")])])],1)]),a("div",{staticClass:"line"}),a("div",{staticClass:"record"},[a("div",{staticClass:"title",staticStyle:{"font-size":"18px"}},[t._v("通知记录")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.recordData,height:"600"}},[a("el-table-column",{attrs:{prop:"userType",label:"客户类型",align:"center","mid-width":"10%"}}),a("el-table-column",{attrs:{prop:"time",label:"发送时间",align:"center","mid-width":"10%"}}),a("el-table-column",{attrs:{prop:"managerName",label:"管理员",align:"center","mid-width":"10%"}}),a("el-table-column",{attrs:{prop:"information",label:"通知内容",align:"center","mid-width":"70%"}})],1)],1),a("div",{staticClass:"line"}),a("el-dialog",{staticClass:"dialog",attrs:{title:"确认删除",visible:t.dialogVisible,width:"25%","lock-scroll":!1,top:"30vh",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"tips"},[t._v(" 删除后无法恢复，是否删除该客户信息？ ")]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"btn",on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),a("div",{staticClass:"btn",on:{click:function(e){return t.deleteCustomer()}}},[t._v("确认")])])])],1)},i=[],n=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),{name:"Customer",data:function(){return{dialogVisible:!1,tableData:[],recordData:[],paging:{page:1,pageSize:6,pageNum:"",hasNextPage:"",hasPreviousPage:"",isFirstPage:"",isLastPage:"",nextPage:"",prePage:""},msg:{textarea:"",customer:""},delUserId:"",token:""}},methods:{getCustomer:function(){var t=this;this.$axios.get("/users/clients",{params:{page:this.paging.page,pageSize:this.paging.pageSize}}).then((function(e){var s=e.data;200===e.status?(t.tableData=s.list,t.paging.page=s.pageNum,t.paging.pageNum=s.pages,t.paging.hasPreviousPage=s.hasPreviousPage,t.paging.hasNextPage=s.hasNextPage,t.paging.isFirstPage=s.isFirstPage,t.paging.isLastPage=s.isLastPage,t.paging.prePage=s.prePage,t.paging.nextPage=s.nextPage):t.$message.error(e.msg)})).catch((function(t){console.log(t)}))},getCustomerPage:function(t){var e=this;0===t&&this.paging.isFirstPage?this.$message.warning("这是已经是首页了"):0===t&&this.paging.isLastPage?this.$message.warning("这是已经是尾页了"):(this.paging.hasPreviousPage||this.paging.hasNextPage||1===t)&&this.$axios.get("/users/clients",{params:{page:t,pageSize:this.paging.pageSize}}).then((function(t){var s=t.data;200===t.status?(e.tableData=s.list,e.paging.page=s.pageNum,e.paging.pageNum=s.pages,e.paging.hasPreviousPage=s.hasPreviousPage,e.paging.hasNextPage=s.hasNextPage,e.paging.isFirstPage=s.isFirstPage,e.paging.isLastPage=s.isLastPage,e.paging.prePage=s.prePage,e.paging.nextPage=s.nextPage):e.$message.error(t.msg)})).catch((function(t){console.log(t)}))},getRecord:function(){var t=this;this.$axios.get("/sms/information").then((function(e){200===e.status?(console.log(e.data),t.recordData=e.data):t.$message.error(e.msg)})).catch((function(t){console.log(t)}))},getDelId:function(t){this.delUserId=t.userId,this.dialogVisible=!0},deleteCustomer:function(){var t=this;this.$axios.delete("/users/clients?userId="+this.delUserId,{data:{userId:this.delUserId}}).then((function(e){200===e.status?(t.dialogVisible=!1,t.$message.success(e.data),t.getCustomer()):t.$message.error(e.msg)})).catch((function(t){console.log(t)}))},exportCustomer:function(){var t="https://acfly.cn/background/users/exportClients",e=new XMLHttpRequest;e.open("get",t,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("token",this.token),e.send(),e.responseType="blob",e.onload=function(){if(200===this.status){var t=this.response,e=window.URL.createObjectURL(t),s=document.createElement("a");s.href=e,s.download="客户记录表",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(e)}else alert("出现了未知的错误!")}},sendSms:function(){var t=this,e=localStorage.getItem("token");"0"===this.msg.customer?(console.log("订阅"),this.$axios.post("/sms/sms",{message:this.msg.textarea,identity:this.msg.customer,token:e}).then((function(e){200===e.status?(t.$message.success(e.data),t.msg.textarea="",t.msg.customer="",t.getRecord()):t.$message.error(e.msg)})).catch((function(t){console.log(t)}))):"1"===this.msg.customer?(console.log("全部"),this.$axios.post("/sms/sms",{message:this.msg.textarea,token:e}).then((function(e){200===e.status?(t.$message.success(e.data),t.msg.textarea="",t.msg.customer="",t.getRecord()):t.$message.error(e.msg)})).catch((function(t){console.log(t)}))):this.$message.error("请先选择要发送的用户类型！")},successMsg:function(){this.$message.success("操作成功！")}},beforeMount:function(){this.token=localStorage.getItem("token"),this.getCustomer(),this.getRecord()}}),o=n,r=(s("d8bf"),s("5fa1"),s("2877")),l=Object(r["a"])(o,a,i,!1,null,"53db7b66",null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-590eeb51.c944e102.js.map